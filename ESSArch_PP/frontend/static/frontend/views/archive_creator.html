<div class="archive-creator margin-top-5">
  <div class="table-container" st-table="vm.creators" st-pipe="vm.creatorPipe">
    <div class="title-action-button-row">
      <div class="title">
        <h4>
          {{'ACCESS.ARCHIVE_CREATORS' | translate}}
        </h4>
      </div>
      <div class="action-button">
        <button class="btn btn-primary" ng-click="vm.createModal()">
          {{'Skapa arkivbildare'}}
        </button>
      </div>
    </div>
    <div class="search-prepare-wrapper">
      <label for items-per-page></label>
      <select
        id="items-per-page"
        style="margin-right: 10px;"
        class="form-control items-per-page"
        ng-model="vm.creatorsPerPage"
        ng-options="x for x in [5,10,20,25,50]"
        uib-tooltip="{{'ITEMSPERPAGE' | translate}}"
        tooltip-placement="auto top"
        tooltip-append-to-body="true"
      ></select>
      <div class="global-search">
        <input
          st-search=""
          class="form-control"
          ng-attr-placeholder="{{'GLOBALSEARCH' | translate}}"
          type="text"
          uib-tooltip="{{'GLOBALSEARCHDESC_STRUCTURES' | translate}}"
          tooltip-placement="auto top"
          tooltip-append-to-body="true"
        />
      </div>
      <button
        type="button"
        ng-click="vm.creatorPipe(tableState)"
        class="btn btn-primary btn-small"
        style="margin-left: 5px;"
        uib-tooltip="{{'SEARCH' | translate}}"
        tooltip-placement="auto top"
        tooltip-append-to-body="true"
      >
        {{'SEARCH' | translate}}&nbsp;<i class="fas fa-search"></i>
      </button>
      <div class="refresh-icon">
        <span
          ng-click="vm.creatorPipe(tableState)"
          class="clickable angular-animate fas fa-sync-alt fa-lg"
          ng-class="{'fa-sync-alt-animate': vm.creatorsLoading }"
          uib-tooltip="{{'REFRESHTABLEDESC' | translate}}"
          tooltip-placement="auto left"
          tooltip-append-to-body="true"
        ></span>
      </div>
    </div>
    <div class="list-view-table table-x-overflow">
      <table class="table table-striped">
        <thead>
          <tr>
            <th st-sort="name">
              {{'NAME' | translate}}
            </th>
            <th st-sort="type">
              {{'TYPE' | translate}}
            </th>
            <th st-sort="cpf">
              {{'ACCESS.CPF' | translate}}
            </th>
            <th>
              {{'START_DATE' | translate}}
            </th>
            <th>
              {{'END_DATE' | translate}}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr
            ng-repeat="x in vm.creators"
            class="clickable"
            ng-class="{'selected': vm.creator.id === x.id}"
            ng-click="vm.creatorClick(x)"
          >
            <td>
              {{x.auth_name.full_name}}
            </td>
            <td>
              {{x.type.main_type.name}}
            </td>
            <td>
              {{x.type.cpf}}
            </td>
            <td>
              {{x.start_date | date:"yyyy-MM-dd"}}
            </td>
            <td>
              {{x.end_date |date:"yyyy-MM-dd"}}
            </td>
          </tr>
          <tr ng-if="!vm.creators.length && !vm.creatorsLoading" class="empty-table-indicator">
            <td colspan="5">{{'NO_RESULTS_FOUND' | translate}}</td>
          </tr>
          <tr ng-if="!vm.creators.length && vm.creatorsLoading" class="empty-table-indicator">
            <td class="loading-column" colspan="5">{{'LOADING' | translate}}</td>
          </tr>
        </tbody>
      </table>
    </div>
    <td ng-show="!initLoad" colspan="2">
      <div
        class="text-center"
        st-template="static/frontend/views/pagination.html"
        st-pagination=""
        st-items-by-page="vm.creatorsPerPage"
        st-displayed-pages="7"
      ></div>
    </td>
  </div>
  <div ng-if="vm.creator !== null">
    <hr />
    <h4 class="pb-base">
      {{vm.creator.auth_name.full_name}}
      <span ng-if="vm.creator.start_date !== null || vm.creator.end_date !== null">
        (
        <span
          ng-if="vm.creator.start_date !== null"
          uib-tooltip="{{ 'START_DATE' | translate }}"
          tooltip-placement="auto top"
          tooltip-append-to-body="true"
        >
          {{vm.creator.start_date | date:"yyyy"}}
        </span>
        -
        <span
          ng-if="vm.creator.end_date !== null"
          uib-tooltip="{{ 'END_DATE' | translate }}"
          tooltip-placement="auto top"
          tooltip-append-to-body="true"
        >
          {{vm.creator.end_date | date:"yyyy"}}
        </span>
        )
      </span>
    </h4>
    <button class="btn btn-default  float-right" ng-click="vm.editModal(vm.creator)">
      {{'EDIT' | translate}}
    </button>
    <uib-tabset active="vm.activePill" ng-init="vm.activePill = 1" type="pills">
      <uib-tab heading="Grunddata" index="1">
        <uib-accordion close-others="false" class="p-base">
          <div uib-accordion-group class="panel-default" is-open="vm.accordion.basic.basic.open" heading="Grunddata">
            <uib-accordion-heading>
              Grunddata
              <i
                class="fas rotate-icon float-right"
                ng-class="{'fa-angle-down': vm.accordion.basic.basic.open, 'fa-angle-right': !vm.accordion.basic.basic.open}"
              ></i>
            </uib-accordion-heading>
            <result-field label="{{'TYPE' | translate}}" data="vm.creator.type.main_type.name"></result-field>
            <result-field label="{{'ACCESS.SUB_TYPE' | translate}}" data="vm.creator.type.sub_type"></result-field>
            <result-field label="{{'ACCESS.CPF' | translate}}" data="vm.creator.type.cpf"></result-field>
            <result-field label="{{'START_DATE' | translate}}" data="vm.creator.start_date"></result-field>
            <result-field label="{{'END_DATE' | translate}}" data="vm.creator.end_date"></result-field>
            <hr ng-if="vm.creator.identifiers.length > 0" class="small" />
            <div ng-if="vm.creator.identifiers.length > 0">
              <label>
                {{'ACCESS.IDENTIFIERS' | translate}}
              </label>
              <div ng-repeat="x in vm.creator.identifiers">
                {{x.type + ': ' + x.identifier}}
              </div>
            </div>
          </div>
          <div
            uib-accordion-group
            class="panel-default"
            is-open="vm.accordion.basic.names.open"
            heading="Alternativa namn"
          >
            <uib-accordion-heading>
              Alternativa namn
              <i
                class="fas rotate-icon float-right"
                ng-class="{'fa-angle-down': vm.accordion.basic.names.open, 'fa-angle-right': !vm.accordion.basic.names.open}"
              ></i>
            </uib-accordion-heading>
            <div class="table-container table-x-overflow">
              <table class="table fat-cells">
                <thead>
                  <tr>
                    <th>
                      {{'NAME' | translate}}
                    </th>
                    <th>
                      {{'DESCRIPTION' | translate}}
                    </th>
                    <th>
                      {{'TYPE' | translate}}
                    </th>
                    <th>
                      {{'START_DATE' | translate}}
                    </th>
                    <th>
                      {{'END_DATE' | translate}}
                    </th>
                    <th>
                      {{'ACCESS.CERTAINTY' | translate}}
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr ng-repeat="x in vm.creator.names">
                    <td>
                      {{(x.part !== null && x.part !== ''? x.part + ', ':'') + x.main}}
                    </td>
                    <td>
                      {{x.description}}
                    </td>
                    <td>
                      {{x.type}}
                    </td>
                    <td>
                      {{x.start_date | date:"yyyy-MM-dd"}}
                    </td>
                    <td>
                      {{x.end_date | date:"yyyy-MM-dd"}}
                    </td>
                    <td>
                      {{x.certainty}}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div uib-accordion-group class="panel-default" is-open="vm.accordion.basic.authority.open">
            <uib-accordion-heading>
              Relaterade auktoritetsposter
              <i
                class="fas rotate-icon float-right"
                ng-class="{'fa-angle-down': vm.accordion.basic.authority.open, 'fa-angle-right': !vm.accordion.basic.authority.open}"
              ></i>
            </uib-accordion-heading>
          </div>
          <div uib-accordion-group class="panel-default" is-open="vm.accordion.basic.resources.open">
            <uib-accordion-heading>
              Relaterade resurser
              <i
                class="fas rotate-icon float-right"
                ng-class="{'fa-angle-down': vm.accordion.basic.resources.open, 'fa-angle-right': !vm.accordion.basic.resources.open}"
              ></i>
            </uib-accordion-heading>
          </div>
        </uib-accordion>
      </uib-tab>
      <uib-tab heading="Historik" idnex="2">
        <uib-accordion close-others="false" class="p-base">
          <div
            uib-accordion-group
            class="panel-default"
            is-open="vm.accordion.history.open"
            heading="Alternativa namn"
          >
            <uib-accordion-heading>
              Historik
              <i
                class="fas rotate-icon float-right"
                ng-class="{'fa-angle-down': vm.accordion.history.open, 'fa-angle-right': !vm.accordion.history.open}"
              ></i>
            </uib-accordion-heading>
            <div ng-if="vm.creator.history.length > 0" ng-repeat="x in vm.creator.history">
              <hr ng-if="$index !== 0" class="small" />
              <div class="flex-row">
                <b
                  >{{x.type}}&nbsp;<span
                    uib-tooltip="{{ 'CREATE_DATE' | translate }}"
                    tooltip-placement="auto top"
                    tooltip-append-to-body="true"
                  >
                    {{x.create_date | date:"yyyy-MM-dd"}}
                  </span>
                  <span
                    ng-if="x.revise_date"
                    uib-tooltip="{{ 'ACCESS.REVISE_DATE' | translate }}"
                    tooltip-placement="auto top"
                    tooltip-append-to-body="true"
                    >({{x.revise_date | date:"yyyy-MM-dd"}})</span
                  >
                </b>
              </div>
              <div class="pt-base">
                {{x.text}}
              </div>
            </div>
          </div>
        </uib-accordion>
      </uib-tab>
      <uib-tab heading="Anmärkningar" index="3">
        <uib-accordion close-others="false" class="p-base">
          <div
            uib-accordion-group
            class="panel-default"
            is-open="vm.accordion.remarks.notes.open"
            heading="Alternativa namn"
          >
            <uib-accordion-heading>
              Anmärkningar
              <i
                class="fas rotate-icon float-right"
                ng-class="{'fa-angle-down': vm.accordion.remarks.notes.open, 'fa-angle-right': !vm.accordion.remarks.notes.open}"
              ></i>
            </uib-accordion-heading>
            <div ng-if="vm.creator.remarks.length > 0" ng-repeat="x in vm.creator.remarks">
              <hr ng-if="$index !== 0" class="small" />
              <div class="flex-row">
                <b
                  >{{x.type}}&nbsp;<span
                    uib-tooltip="{{ 'CREATE_DATE' | translate }}"
                    tooltip-placement="auto top"
                    tooltip-append-to-body="true"
                  >
                    {{x.create_date | date:"yyyy-MM-dd"}}
                  </span>
                  <span
                    ng-if="x.revise_date"
                    uib-tooltip="{{ 'ACCESS.REVISE_DATE' | translate }}"
                    tooltip-placement="auto top"
                    tooltip-append-to-body="true"
                    >&nbsp;({{x.revise_date | date:"yyyy-MM-dd"}})</span
                  >
                </b>
              </div>
              <div class="pt-base">
                {{x.text}}
              </div>
            </div>
          </div>
        </uib-accordion>
      </uib-tab>
      <uib-tab heading="Topografi" index="4">
        <uib-accordion close-others="false" class="p-base">
          <div
            uib-accordion-group
            class="panel-default"
            is-open="vm.accordion.topography.open"
            heading="Alternativa namn"
          >
            <uib-accordion-heading>
              Platser
              <i
                class="fas rotate-icon float-right"
                ng-class="{'fa-angle-down': vm.accordion.topography.open, 'fa-angle-right': !vm.accordion.topography.open}"
              ></i>
            </uib-accordion-heading>
            <div ng-if="vm.creator.places.length > 0" ng-repeat="x in vm.creator.places">
              <hr ng-if="$index !== 0" class="small" />
              <result-field label="{{'NAME' | translate}}" data="x.topography.name"></result-field>
              <result-field label="{{'TYPE' | translate}}" data="x.type"></result-field>
              <result-field label="{{'DESCRIPTION' | translate}}" data="x.description"></result-field>
              <result-field label="{{'CREATE_DATE' | translate}}" data="x.create_date" type="date"></result-field>
              <result-field
                label="{{'ACCESS.REVISE_DATE' | translate}}"
                data="x.revise_date"
                type="date"
              ></result-field>
              <result-field label="{{'END_DATE' | translate}}" data="x.end_date" type="date"></result-field>
              <result-field label="{{'ACCESS.ALT_NAME' | translate}}" data="x.topography.alt_name"></result-field>
              <result-field
                label="{{'ACCESS.MAIN_CATEGORY' | translate}}"
                data="x.topography.main_category"
              ></result-field>
              <result-field
                label="{{'ACCESS.SUB_CATEGORY' | translate}}"
                data="x.topography.sub_category"
              ></result-field>
              <result-field
                label="{{'ACCESS.REFERENCE_CODE' | translate}}"
                data="x.topography.reference_code"
              ></result-field>
              <result-field label="{{'ACCESS.START_YEAR' | translate}}" data="x.topography.start_year"></result-field>
              <result-field label="{{'ACCESS.END_YEAR' | translate}}" data="x.topography.end_year"></result-field>
              <result-field label="{{'ACCESS.LONGITUDE' | translate}}" data="x.topography.lng"></result-field>
              <result-field label="{{'ACCESS.LATITUDE' | translate}}" data="x.topography.lat"></result-field>
            </div>
          </div>
        </uib-accordion>
      </uib-tab>
    </uib-tabset>
  </div>
</div>
